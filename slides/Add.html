<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <input id="upload"  type="file" accept="video/*"  onchange="upload(event)" >
    

   
    
    


        <script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-storage.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-firestore.js"></script>


<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyBhfC48yDcNIReW-ILXtXpH1uFUNI93bVg",
    authDomain: "campuscrop-df2e9.firebaseapp.com",
    projectId: "campuscrop-df2e9",
    storageBucket: "campuscrop-df2e9.appspot.com",
    messagingSenderId: "994771260982",
    appId: "1:994771260982:web:09f0ece6defb5093f32a97",
    measurementId: "G-PCTGF2NYB0"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();

 
</script>
<script>
    async function  upload(event){
         console.log(event.path[0].baseURI);
         const path = event.path[0].baseURI;
         const childPath = `post/${Math.random().toString(36)}`;
         
        
         const response = await fetch(path);
         
         const blob = await response.blob();
         const email = "revanthreddyyaddu@gmail.com";
         const password = "thappu";

         firebase.auth().signInWithEmailAndPassword(email,password);
         

         const task = firebase.storage().ref().child(childPath).put(blob);

       const taskProgress = snapshot =>{
           console.log(`transferred:${snapshot.bytesTransferred}`)
       };
       const taskCompleted = ()=>{
         console.log(task.snapshot);
       }
       const taskError = snapshot=>{
           console.log(snapshot);
       }

       task.on("state_changed",taskProgress,taskError,taskCompleted);

       function saveData(downloadurl){ 
        firebase.firestore().collection('posts').doc(firebase.auth().currentUser.uid)
           .collection('userPosts').add({
               downloadURL:downloadurl,
               creation:firebase.firestore.FieldValue.serverTimestamp()
           }).then(()=>{})
       }

       }

       


   
</script>
    
</body>
</html>